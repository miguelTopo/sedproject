<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
		
<f:view>
	<style type="text/css">
	#qualificationSection article{
		padding-left: 35px;
		padding-right: 35px;
		display: inline-block;
	}
	</style>
	<h:form id="teacherQualificationForm">
		<p:panel header="Calificaciones">
			<div style="padding-left: 25px;padding-right: 25px;">
				<p>
					A continuación se muestra el formulario para realizar el proceso de calificaciones de los estudiantes. Se muestra el listado de cursos que usted tiene asignados, asi mismo como las materias asignadas. 
				</p>
				<p>#{bundle['page.core.labelDataObligatory']}</p>
				<br/>
				<br/>
			</div>
			<section id="qualificationSection">
				<article style="width: 276px;">
					<table style="width:100%">
						<tr>
							<td style="width:20%">
								*Curso:
							</td>
							<td style="width:80%">
								<p:selectOneMenu id="somTeacherCourse" value="#{teacherQualificationBean.idCourse}" style="width:98%">
									<f:selectItem itemLabel="#{bundle['page.core.labelSelectOne']}" itemValue="0"/>
									<f:selectItems value="#{teacherQualificationBean.courseTeacherList}" var="c" itemLabel="#{c.name}" itemValue="#{c.id}"/>
									<p:ajax listener="#{teacherQualificationBean.handleCourseChange}" process="@this" 
										update=":teacherQualificationForm:somTeacherSubject :teacherQualificationForm:studentQualificationOp"/>
								</p:selectOneMenu>
								<div id="tqCourse_DIV" class="ui-invalid-field"/>
							</td>
						</tr>
					</table>
				</article>
				<article style="width: 500px;">
					<table style="width:100%">
						<tr>
							<td style="width:20%">
								*Materia:
							</td>
							<td style="width:80%">
								<p:selectOneMenu id="somTeacherSubject" value="#{teacherQualificationBean.idSubject}" disabled="#{teacherQualificationBean.idCourse eq null or teacherQualificationBean.idCourse eq 0}"
									style="width:98%">
									<f:selectItem itemLabel="#{bundle['page.core.labelSelectOne']}" itemValue="0"/>
									<f:selectItems value="#{teacherQualificationBean.subjectTeacherList}" var="s" itemLabel="#{s.name}" itemValue="#{s.id}"/>
									<p:ajax process="@this" update=":teacherQualificationForm:studentQualificationOp" listener="#{teacherQualificationBean.cleanQualificationView}"/>
								</p:selectOneMenu>
								<div id="tqSubject_DIV" class="ui-invalid-field"/>
							</td>
						</tr>
					</table>
				</article>
			</section>
			<div style="text-align: right;padding-bottom: 25px;padding-right: 100px;">
				<p:commandButton id="btnLoadQualification" value="Ir a Notas" action="#{teacherQualificationBean.loadStudentSubjectList}" 
					onclick="validateLoadQualification()" type="button"/>
			</div> 
			<p:outputPanel id="studentQualificationOp">
				<p:outputPanel rendered="#{!empty teacherQualificationBean.studentList}">
				
					<p:dataTable value="#{teacherQualificationBean.studentList}" var="s" filteredValue="#{teacherQualificationBean.studentFilterList}">
					
						<p:column headerText="Identificación" sortBy="#{s.identification}" filterBy="#{s.identification}" 
							filterMatchMode="contains" filterStyle="width:90%">
							#{s.identification}
						</p:column>
				
						<p:column headerText="Apellidos" sortBy="#{s.lastName}" filterBy="#{s.lastName}" 
							filterMatchMode="contains" filterStyle="width:90%">
							#{s.lastName}
						</p:column>
				
						<p:column headerText="Nombres" sortBy="#{s.name}" filterBy="#{s.name}" filterMatchMode="contains" 
							filterStyle="width:90%">
							#{s.name}
						</p:column>
					
						<c:forEach begin="0" end="#{fn:length(teacherQualificationBean.qualificationTypeList)-1}" var="q">
							<p:column style="width:35px;" headerText="#{teacherQualificationBean.qualificationTypeList.get(q).name}">
								<pe:inputNumber value="#{s.qualificationList.get(q).value}" decimalSeparator="," style="width:30px;" decimalPlaces="1" disabled="#{s.qualificationList.get(q).idQualificationType eq 4}"/>
							</p:column>
						</c:forEach>
					</p:dataTable>		
					<div style="text-align:center;padding-top: 20px;">
						<p:commandButton value="Guardar Notas" action="#{teacherQualificationBean.saveQualificationList}" styleClass="ui-priority-primary" 
							update=":teacherQualificationForm:studentQualificationOp"/>
					</div>		
				</p:outputPanel>
			</p:outputPanel>
			
		</p:panel>
	</h:form>
</f:view>
</html>