<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
<f:view>
		<style type="text/css">
			section article{
			width: 370px;
			display: inline-block;
			}
			table{
				width:100%;
				border-spacing: 5px;
			}
			.ui-label-table{
				width:35%;
			}
			.ui-content-table{
				width:65%;
			}
			
	</style>
	<h:form id="addSedUserForm">
		<p:panel id="addSedUserPanel" header="#{sedUserBean.showAdd ? bundle['page.seduser.labelAddUser'] : bundle['page.seduser.labelEditUser']}">
			<div style="padding:25px;">
				<div style="padding-bottom: 25px;">
					<p>
						<h:outputText value="#{bundle['page.seduser.labelGuideAddSedUser']}" rendered="#{sedUserBean.showAdd}" />
						<h:outputText value="#{bundle['page.seduser.labelGuideEditSedUser']}" rendered="#{sedUserBean.showEdit}" />
					</p>
				</div>
				<section>
					<article style="width:100%;">
					<div class="ui-subtitle-sed">
						<h4 style="color: white;">
							#{bundle['page.seduser.labelPersonalData']}
						</h4>
					</div>
					
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
										<strong>
											#{bundle['page.student.labelStudentLastName']}:
										</strong>
								</td>
								<td class="ui-content-table">
									<p:inputText id="txtSuLastName" value="#{sedUserBean.sedUser.lastName}" style="width:95%"/>
								</td>
							</tr>
						</table>
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.student.labelStudentName']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:inputText id="txtSuName" value="#{sedUserBean.sedUser.name}" style="width:95%"/>
								</td>
							</tr>
						</table>
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.student.labelIdentificationType']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:selectOneMenu id="somIdType" value="#{sedUserBean.sedUser.idIdentificationType}" style="width:98%">
										<f:selectItem itemLabel="#{bundle['page.core.labelSelectOne']}" itemValue="0" />
										<f:selectItems value="#{sedUserBean.identificationTypeList}" var="itl" itemLabel="#{itl.name}" itemValue="#{itl.id}" />
									</p:selectOneMenu>
									<div id="valIdType_DIV" class="ui-invalid-field"/>
								</td>
							</tr>
						</table>
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.student.labelStudentIdentification']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:inputText id="txtSuIdentification" value="#{sedUserBean.sedUser.identification}" style="width:95%">
										<p:ajax event="blur" process="@this" update=":addSedUserForm:opIdentExist"
											listener="#{sedUserBean.validateIdentification}" />
									</p:inputText>
									<pe:keyFilter for="txtSuIdentification" mask="pint" /> 
						
									<p:outputPanel id="opIdentExist">
										<p:outputPanel rendered="#{sedUserBean.existIdentification}">
											<h:outputText value="#{bundle['page.seduser.labelExistIdentification']}" styleClass="ui-invalid-field" />
										</p:outputPanel>
									</p:outputPanel>
								</td>
							</tr>
						</table>
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.student.labelStudentEmail']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:inputText id="txtSuEmail" value="#{sedUserBean.sedUser.email}" style="width:95%;text-transform:lowercase;">
										<p:ajax process="@this" update=":addSedUserForm:opEmailExist" listener="#{sedUserBean.validateEmail}" event="blur" />
									</p:inputText> 
						
									<p:outputPanel id="opEmailExist">
										<p:outputPanel rendered="#{sedUserBean.existEmail}">
											<h:outputText value="#{bundle['page.seduser.labelExistEmail']}" styleClass="ui-invalid-field" />
										</p:outputPanel>
									</p:outputPanel>
								</td>
							</tr>
						</table>
					</article>
					<article style="padding-left: 176px;">
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										Tipo de usuario:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:selectOneMenu id="somSedRole" value="#{sedUserBean.sedUser.idSedRole}" style="width:98%">
										<f:selectItem itemValue="0" itemLabel="#{bundle['page.core.labelSelectOne']}"/>
										<f:selectItems value="#{sedUserBean.sedRoleList}" var="r" itemLabel="#{r.name}" itemValue="#{r.id}"/>
										<p:ajax process="@this" update=":addSedUserForm:opChangeRole" listener="#{sedUserBean.handleRoleChange}"/>
									</p:selectOneMenu>
									<div id="valIdSedRole_DIV" class="ui-invalid-field"/>
								</td>
							</tr>
						</table>
					</article>
					
					<p:outputPanel id="opChangeRole">
						<p:outputPanel rendered="#{sedUserBean.sedUser.idSedRole eq 3}">
							<ui:include src="/WEB-INF/includes/sedUser/panelStudentRole.xhtml" />
						</p:outputPanel>
						<p:outputPanel rendered="#{sedUserBean.sedUser.idSedRole eq 4}">
							<ui:include src="/WEB-INF/includes/sedUser/panelStudentResponsibleRole.xhtml" />
						</p:outputPanel>
					</p:outputPanel>
					
					<div class="ui-subtitle-sed">
						<h4 style="color: white;">
							#{bundle['page.seduser.labelUserData']}
						</h4>
					</div>
					<div style="padding-top: 20px;">
						<p>
							<h:outputText value="#{bundle['page.seduser.pw.labelGuideAddSedUser']}" escape="false" rendered="#{sedUserBean.showAdd}" />
							<h:outputText value="#{bundle['page.seduser.pw.labelGuideEditSedUser']}" escape="false" rendered="#{sedUserBean.showEdit}" />
						</p>
					</div>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.seduser.labelUserType']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:selectOneMenu id="somRole" value="#{sedUserBean.sedUser.idSedRole}" style="width:98%">
										<f:selectItem itemLabel="#{bundle['page.core.labelSelectOne']}" itemValue="0" />
										<f:selectItems value="#{sedUserBean.sedRoleList}" var="sr" itemLabel="#{sr.name}" itemValue="#{sr.id}" />
									</p:selectOneMenu>
									<div id="valRole_DIV" class="ui-invalid-field"/>
								</td>
							</tr>
						</table>
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.login.labelPassword']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:password id="userPw" value="#{sedUserBean.userPassword}" disabled="#{sedUserBean.randomPassword}" style="width:95%"/>
								</td>
							</tr>
						</table>
					</article>
					<article>
						<table>
							<tr>
								<td class="ui-label-table">
									<strong>
										#{bundle['page.login.labelRepeatPassword']}:
									</strong>
								</td>
								<td class="ui-content-table">
									<p:password id="userPwRetry" value="#{sedUserBean.confirmPassword}" disabled="#{sedUserBean.randomPassword}" style="width:95%"/>
								</td>
							</tr>
						</table>
					</article>
				</section>
				<br/>
				<br/>
				<section>
					<article style="width:100%;">
						<p:selectBooleanCheckbox id="booleanPassword" value="#{sedUserBean.randomPassword}">
							<p:ajax process="@this" update=":addSedUserForm:userPw :addSedUserForm:userPwRetry :addSedUserForm:btnAddSedUser" />
						</p:selectBooleanCheckbox>
						
						<p:spacer width="20" /> 
						
						<p:commandLink value="Generar contraseña automáticamente." action="#{sedUserBean.activeRandomPassword}" 
							process="@this" update=":addSedUserForm:booleanPassword :addSedUserForm:userPw :addSedUserForm:userPwRetry :addSedUserForm:btnAddSedUser"/>					
					</article>
				</section>

			<div align="center">
				<p:commandButton id="btnAddSedUser" value="#{bundle['page.seduser.labelAddUser']}" onclick="validateAddSedUser(#{sedUserBean.randomPassword});" 
					type="button" styleClass="ui-priority-primary" action="#{sedUserBean.saveSedUser}" rendered="#{sedUserBean.showAdd}" />
				<p:commandButton value="Guardar Cambios" action="#{sedUserBean.updateSedUser}" rendered="#{sedUserBean.showEdit}"/>
				<p:spacer width="5" />
				<p:commandButton value="#{bundle['page.core.labelGoBack']}" action="#{sedUserBean.goBack}" icon="ui-icon-arrow-1-w" />
			</div>
			</div>
		</p:panel>
		<br />
	</h:form>
	
	<ui:include src="/WEB-INF/includes/sedUser/dialogSedUser.xhtml" />
	
	
</f:view>
</html>